# =========================
# PowerMem Java SDK (.env)
# =========================
#
# Usage:
# - Copy this file to `.env` in the project root
# - Java reads it via `ConfigLoader.fromEnvAndDotEnv()` from `${user.dir}/.env`
# - System environment variables override `.env` (recommended for CI/secrets)
#

# -------------------------
# Vector Store: choose one
# -------------------------
# sqlite | oceanbase | ob
DATABASE_PROVIDER=sqlite

# ========== SQLite ==========
SQLITE_PATH=./data/powermem_dev.db
SQLITE_ENABLE_WAL=true
SQLITE_TIMEOUT=30

# ========== OceanBase (MySQL mode) ==========
# Applies when DATABASE_PROVIDER=oceanbase/ob
OCEANBASE_HOST=127.0.0.1
OCEANBASE_PORT=2881
OCEANBASE_USER=root@sys
OCEANBASE_PASSWORD=your_password
OCEANBASE_DATABASE=ai_work
OCEANBASE_COLLECTION=memories

# Embedding dims: used when creating `embedding VECTOR(dims)` and ANN index (best-effort).
# Note: must match your actual embedding model dims, otherwise writes/queries may fail.
OCEANBASE_EMBEDDING_MODEL_DIMS=1536

# ANN index (best-effort; syntax may vary by OceanBase version)
OCEANBASE_INDEX_TYPE=IVF_FLAT      # HNSW / IVF_FLAT / ...
OCEANBASE_VECTOR_METRIC_TYPE=cosine # cosine / l2 / inner_product
OCEANBASE_VIDX_NAME=memories_vidx

# Hybrid search (vector + fulltext) (best-effort)
OCEANBASE_HYBRID_SEARCH=true
OCEANBASE_FULLTEXT_PARSER=ik        # ik / ngram / ngram2 / beng / space (depends on your OceanBase build)
OCEANBASE_VECTOR_WEIGHT=0.5
OCEANBASE_FTS_WEIGHT=0.5
OCEANBASE_FUSION_METHOD=rrf         # rrf / weighted
OCEANBASE_RRF_K=60

# The following fields are reserved for Python config parity (Java uses defaults in most cases)
OCEANBASE_PRIMARY_FIELD=id
OCEANBASE_VECTOR_FIELD=embedding
OCEANBASE_TEXT_FIELD=document
OCEANBASE_METADATA_FIELD=metadata

# Connection/timeout (maps to VectorStoreConfig.timeoutSeconds)
# You can also use vector_store.timeoutSeconds when using properties/map input
OCEANBASE_TIMEOUT_SECONDS=15

# -------------------------
# LLM (OpenAI/Qwen compatible)
# -------------------------
# mock | openai | qwen
LLM_PROVIDER=mock
LLM_API_KEY=sk-xxx
LLM_MODEL=qwen-plus

# OpenAI-compatible base URL (compatibility mode)
QWEN_LLM_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1
# OPENAI_LLM_BASE_URL=https://api.openai.com/v1

LLM_TEMPERATURE=0.2
LLM_MAX_TOKENS=1024
LLM_TOP_P=1.0
LLM_TOP_K=0
LLM_ENABLE_SEARCH=false

# -------------------------
# Embeddings
# -------------------------
# mock | openai | qwen
EMBEDDING_PROVIDER=mock
EMBEDDING_API_KEY=sk-xxx
EMBEDDING_MODEL=text-embedding-v4
EMBEDDING_DIMS=1536

# OpenAI-compatible base URL (compatibility mode)
QWEN_EMBEDDING_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1
# OPEN_EMBEDDING_BASE_URL=https://api.openai.com/v1

# -------------------------
# Sub Stores (routing, optional)
# -------------------------
# Python: sub_stores are mainly used for OceanBase multi-table / multi-model routing.
# Java: routes by metadata/filters to different VectorStore + Embedder pairs (also works with sqlite).
#
# Configuration:
# - Set SUB_STORES_COUNT, or just define SUB_STORE_<i>_* keys (indices are auto-detected)
# - Each sub store must define at least one route condition: SUB_STORE_<i>_ROUTE_<KEY>=<VALUE>
# - Sub stores can override VectorStore/Embedder config via SUB_STORE_<i>_ prefixed keys
#
# Example: route metadata.category=pref to a dedicated sub store
SUB_STORES_COUNT=1
SUB_STORE_0_COLLECTION=memories_pref
SUB_STORE_0_ROUTE_CATEGORY=pref
SUB_STORE_0_READY=true
SUB_STORE_0_DATABASE_PROVIDER=sqlite
SUB_STORE_0_SQLITE_PATH=./data/powermem_sub_pref.db
#
# Optional: use a dedicated embedder (defaults to inheriting the main embedder config)
SUB_STORE_0_EMBEDDING_PROVIDER=mock
# SUB_STORE_0_EMBEDDING_API_KEY=your_api_key_here
# SUB_STORE_0_EMBEDDING_MODEL=text-embedding-v4
# SUB_STORE_0_EMBEDDING_DIMS=1536
# SUB_STORE_0_EMBEDDING_BASE_URL=https://dashscope.aliyuncs.com/api/v1

# -------------------------
# Reranker (Hybrid fine ranking, optional)
# -------------------------
# qwen | dashscope
RERANKER_PROVIDER=
RERANKER_API_KEY=
# China (Beijing): gte-rerank-v2 ; Intl (Singapore): qwen3-rerank
RERANKER_MODEL=gte-rerank-v2
# top_k used for rerank (final results)
RERANKER_TOP_K=10
# Optional. If not set, SDK will choose default endpoint by model.
# Examples:
# - https://dashscope.aliyuncs.com/api/v1/services/rerank/text-rerank/text-rerank
# - https://dashscope-intl.aliyuncs.com/compatible-api/v1/reranks
RERANKER_BASE_URL=

# -------------------------
# Intelligent Memory (Ebbinghaus)
# -------------------------
INTELLIGENT_MEMORY_ENABLED=true
INTELLIGENT_MEMORY_INITIAL_RETENTION=1.0
INTELLIGENT_MEMORY_DECAY_RATE=0.02
INTELLIGENT_MEMORY_REINFORCEMENT_FACTOR=1.2
INTELLIGENT_MEMORY_WORKING_THRESHOLD=0.8
INTELLIGENT_MEMORY_SHORT_TERM_THRESHOLD=0.5
INTELLIGENT_MEMORY_LONG_TERM_THRESHOLD=0.2

MEMORY_DECAY_ENABLED=true
MEMORY_DECAY_ALGORITHM=ebbinghaus
MEMORY_DECAY_BASE_RETENTION=1.0
MEMORY_DECAY_FORGETTING_RATE=0.02
MEMORY_DECAY_REINFORCEMENT_FACTOR=1.2

# -------------------------
# Agent Memory
# -------------------------
AGENT_ENABLED=false
AGENT_MEMORY_MODE=default
AGENT_DEFAULT_SCOPE=global
AGENT_DEFAULT_PRIVACY_LEVEL=private
AGENT_DEFAULT_COLLABORATION_LEVEL=none
AGENT_DEFAULT_ACCESS_PERMISSION=read
AGENT_ENABLE_COLLABORATION=false

# -------------------------
# Telemetry
# -------------------------
TELEMETRY_ENABLED=false
TELEMETRY_ENDPOINT=
TELEMETRY_API_KEY=
TELEMETRY_BATCH_SIZE=50
TELEMETRY_FLUSH_INTERVAL=10

# -------------------------
# Audit / Logging
# -------------------------
AUDIT_ENABLED=false
AUDIT_LOG_FILE=./logs/audit.log
AUDIT_LOG_LEVEL=INFO
AUDIT_RETENTION_DAYS=7
AUDIT_COMPRESS_LOGS=true
AUDIT_LOG_ROTATION_SIZE=50MB

LOGGING_LEVEL=INFO
LOGGING_FORMAT=text
LOGGING_FILE=
LOGGING_MAX_SIZE=50MB
LOGGING_BACKUP_COUNT=3
LOGGING_COMPRESS_BACKUPS=true
LOGGING_CONSOLE_ENABLED=true
LOGGING_CONSOLE_LEVEL=INFO
LOGGING_CONSOLE_FORMAT=text

# -------------------------
# Custom prompts (optional)
# -------------------------
# You can provide a full prompt as one string (recommend quoting; \n is supported inside quotes)
CUSTOM_FACT_EXTRACTION_PROMPT=
CUSTOM_UPDATE_MEMORY_PROMPT=
CUSTOM_IMPORTANCE_EVALUATION_PROMPT=

